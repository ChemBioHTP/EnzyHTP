{
    "api": "general",
    "store_as": "general",
    "args": {
      "pdb_path": "../data/7si9_rm_water_disconnected_changed_angle.pdb",
      "remove_polypeptide_hydrogen_only": true,
      "solvent_ph": 7.4,
      "if_protonate_ligand": false,
      "polypeptide_protonation_engine": "pdb2pqr",
      "assign_mutant_pattern": "{WT}",
      "md_cluster_job_config": "md_cluster_job_config",
      "md_prod_time": 0.5,
      "md_record_period": 0.05,
      "qm_engine": "gaussian",
      "qm_cluster_job_config": "qm_cluster_job_config",
      "qm_level_of_theory": "qm_level_of_theory",
      "qm_job_check_period": 60,
      "qm_job_array_size": 20,
      "bond_p1": "bond_p1",
      "bond_p2": "bond_p2",
      "qm_region_pattern": ["resi 41+145+163+164+165+166+207"],
      "workunits": [
        {
          "api": "read_pdb",
          "store_as": "structure",
          "args": { 
            "path": "`pdb_path`"
          }
        },
        {
          "api": "remove_hydrogens",
          "store_as": "structure",
          "args": {
            "stru": "`structure`",
            "polypeptide_only": "`remove_polypeptide_hydrogen_only`"
          }
        },
        {
          "api": "protonate_stru",
          "args": {
            "stru": "`structure`",
            "ph": "`solvent_ph`",
            "protonate_ligand": "`if_protonate_ligand`",
            "engine": "`polypeptide_protonation_engine`"
          }
        },
        {
          "api": "assign_mutant",
          "store_as": "assign_mutant",
          "args": {
            "stru": "`structure`",
            "pattern": "`assign_mutant_pattern`"
          }
        },
        {
          "api": "loop",
          "store_as": "loop_unit_lv0",
          "args": {
            "loop_data": "`assign_mutant`",
            "loop_datum_varname": "mutant_datum",
            "workunits": [
              {
                "api": "mutate_stru",
                "store_as": "mutant_stru",
                "args": {
                  "stru": "`structure`",
                  "mutant": "`mutant_datum`",
                  "engine": "pymol"
                }
              },
              {
                "api": "build_md_parameterizer",
                "store_as": "param_method"
              },
              {
                "api": "equi_md_sampling",
                "store_as": "md_result",
                "args": {
                    "stru": "`structure`",
                    "param_method": "`param_method`",
                    "cluster_job_config": "`md_cluster_job_config`",
                    "prod_time": "`md_prod_time`",
                    "record_period": "`md_record_period`"
                }
              },
              {
                "api": "loop",
                "store_as": "loop_unit_lv1",
                "args": {
                    "loop_data": "`md_result`",
                    "loop_datum_varname": "replica_esm",
                    "workunits": [
                        {
                            "api": "single_point",
                            "store_as": "qm_results",
                            "args": {
                                "stru": "`replica_esm`",
                                "engine": "`qm_engine`",
                                "method": "`qm_level_of_theory`",
                                "regions": "`qm_region_pattern`",
                                "cluster_job_config": "`qm_cluster_job_config`",
                                "job_check_period": "`qm_job_check_period`",
                                "job_array_size": "`qm_job_array_size`"
                            }
                        },
                        {
                            "api": "loop",
                            "store_as": "loop_unit_lv2",
                            "args": {
                                "loop_data": "`qm_results`",
                                "loop_datum_varname": "ele_stru",
                                "workunits": [
                                    {
                                        "api": "bond_dipole",
                                        "store_as": "dipole",
                                        "args": {
                                            "ele_stru": "`ele_stru`",
                                            "atom_1": "`bond_p1`",
                                            "atom_2": "`bond_p2`"
                                        }
                                    },
                                    {
                                        "api": "get_attr",
                                        "store_as": "topology",
                                        "args": {
                                          "obj": "`ele_stru`",
                                          "attr_chain": ["geometry", "topology"]
                                        }
                                    },
                                    {
                                        "api": "ele_field_strength_at_along",
                                        "store_as": "field_strength",
                                        "args": {
                                          "stru": "`topology`",
                                          "p1": "`bond_p1`",
                                          "p2": "`bond_p2`"
                                        }
                                    },
                                    {
                                        "api": "get_item",
                                        "store_as": "dipole_0",
                                        "args": {
                                          "obj": "`dipole`",
                                          "index": 0
                                        }
                                    },
                                    {
                                        "api": "ele_stab_energy_of_bond",
                                        "store_as": "dg_ele",
                                        "args": {
                                          "bond_dipole": "`dipole_0`",
                                          "bond_field_strength": "`field_strength`"
                                        }
                                    }
                                ]
                            }
                        }
                    ]
                }
              }
            ]
          }
        }
      ]
    }
  }
  